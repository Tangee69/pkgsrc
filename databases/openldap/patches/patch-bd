$NetBSD: patch-bd,v 1.3 2008/01/13 17:15:17 ghen Exp $

--- configure.in.orig	2007-10-17 01:43:09.000000000 +0200
+++ configure.in
@@ -338,6 +338,7 @@ Overlays="accesslog \
 	retcode \
 	rwm \
 	seqmod \
+	smbk5pwd \
 	syncprov \
 	translucent \
 	unique \
@@ -374,6 +375,8 @@ OL_ARG_ENABLE(rwm,[    --enable-rwm     
 	no, [no yes mod], ol_enable_overlays)
 OL_ARG_ENABLE(seqmod,[    --enable-seqmod	  Sequential Modify overlay],
 	yes, [no yes mod], ol_enable_overlays)
+OL_ARG_ENABLE(smbk5pwd,[    --enable-smbk5pwd	  smbk5pwd overlay],
+	yes, [no yes mod], ol_enable_overlays)
 OL_ARG_ENABLE(syncprov,[    --enable-syncprov	  Syncrepl Provider overlay],
 	yes, [no yes mod], ol_enable_overlays)
 OL_ARG_ENABLE(translucent,[    --enable-translucent  Translucent Proxy overlay],
@@ -536,6 +539,7 @@ BUILD_REFINT=no
 BUILD_RETCODE=no
 BUILD_RWM=no
 BUILD_SEQMOD=no
+BUILD_SMBK5PWD=no
 BUILD_SYNCPROV=no
 BUILD_TRANSLUCENT=no
 BUILD_UNIQUE=no
@@ -2793,6 +2797,18 @@ if test "$ol_enable_rwm" != no ; then
 	AC_DEFINE_UNQUOTED(SLAPD_OVER_RWM,$MFLAG,[define for Rewrite/Remap overlay])
 fi
 
+if test "$ol_enable_smbk5pwd" != no ; then
+	BUILD_SMBK5PWD=$ol_enable_smbk5pwd
+	if test "$ol_enable_smbk5pwd" = mod ; then
+		MFLAG=SLAPD_MOD_DYNAMIC
+		SLAPD_DYNAMIC_OVERLAYS="$SLAPD_DYNAMIC_OVERLAYS smbk5pwd.la"
+	else
+		MFLAG=SLAPD_MOD_STATIC
+		SLAPD_STATIC_OVERLAYS="$SLAPD_STATIC_OVERLAYS smbk5pwd.o"
+	fi
+	AC_DEFINE_UNQUOTED(SLAPD_OVER_SMBK5PWD,$MFLAG,[define for smbk5pwd overlay])
+fi
+
 if test "$ol_enable_seqmod" != no ; then
 	BUILD_SEQMOD=$ol_enable_seqmod
 	if test "$ol_enable_seqmod" = mod ; then
@@ -2920,6 +2936,7 @@ dnl overlays
   AC_SUBST(BUILD_RETCODE)
   AC_SUBST(BUILD_RWM)
   AC_SUBST(BUILD_SEQMOD)
+  AC_SUBST(BUILD_SMBK5PWD)
   AC_SUBST(BUILD_SYNCPROV)
   AC_SUBST(BUILD_TRANSLUCENT)
   AC_SUBST(BUILD_UNIQUE)
