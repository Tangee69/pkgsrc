$NetBSD: patch-ab,v 1.5 2008/12/24 17:56:11 jmcneill Exp $

--- configure.ac.orig	2008-11-23 12:16:28.000000000 -0500
+++ configure.ac	2008-12-24 12:48:29.000000000 -0500
@@ -176,7 +176,6 @@
 dnl ================================================================
 
 PKG_CHECK_MODULES(GEDIT, [
-	sm >= 1.0.0
 	libxml-2.0 >= 2.5.0
 	glib-2.0 >= 2.13.0
 	gthread-2.0 >= 2.13.0
@@ -189,6 +188,18 @@
 AC_SUBST(GEDIT_LIBS)
 AC_SUBST(GEDIT_CFLAGS)
 
+PKG_CHECK_MODULES(SM, sm >= $1.0.0, [HAVE_SM=yes], [HAVE_SM=no])
+if test x$HAVE_SM = xno; then
+  AC_PATH_XTRA
+  if test "x$no_x" = xyes; then
+    AC_MSG_ERROR(X11 and sm development libraries not found);
+  else
+    XLIB_LIBS="$X_PRE_LIBS $X_LIBS -lSM -lICE $X_EXTRA_LIBS"
+    XLIB_CFLAGS=$X_CFLAGS
+  fi
+fi
+GEDIT_CFLAGS="$GEDIT_CFLAGS $SM_CFLAGS $XLIB_CFLAGS"
+GEDIT_LIBS="$GEDIT_LIBS $SM_LIBS $XLIB_LIBS"
 
 dnl ================================================================
 dnl GConf related settings
