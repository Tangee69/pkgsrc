$NetBSD: patch-af,v 1.2 2008/01/05 21:14:10 tron Exp $

--- configure.orig	2006-11-25 21:02:18.000000000 +0000
+++ configure	2008-01-05 20:21:50.000000000 +0000
@@ -18971,7 +18971,7 @@
 if test "x$use_cygwin" = "xyes"; then
         LDFLAGS="$LDFLAGS -lpthreadGC1 "
 else
-        LDFLAGS="$LDFLAGS -lpthread -lX11 -lXext -L/usr/X11R6/lib"
+        LDFLAGS="$LDFLAGS ${PTHREAD_LDFLAGS} ${PTHREAD_LIBS} -lX11 -lXext ${X11_LDFLAGS}"
 fi
 
 
@@ -25269,6 +25269,20 @@
 
 		have_little_endian=yes;
 
+case $host_os in
+darwin*)
+cat >>confdefs.h <<\_ACEOF
+#define FPM_INTEL 1
+_ACEOF
+
+
+cat >>confdefs.h <<\_ACEOF
+#define RUNTIME_CPUDETECT 1
+_ACEOF
+
+
+  ;;
+*)
 cat >>confdefs.h <<\_ACEOF
 #define ARCH_X86 1
 _ACEOF
@@ -25290,6 +25304,8 @@
 
                 use_mmx=1
 		echo "X86 is ON"
+  ;;
+esac
 		;;
 	x86_64|amd64)
 		have_little_endian=yes;
@@ -25715,7 +25731,7 @@
 
   	#include <stdlib.h>
 
-	#if !defined (__FreeBSD__) && !defined(__NetBSD__) && !defined(__OpenBSD__) && !defined(__APPLE__)
+	#if !defined (__FreeBSD__) && !defined(__NetBSD__) && !defined(__OpenBSD__) && !defined(__APPLE__) && !defined(__DragonFly__)
 		#error
 	#endif
 
@@ -26637,6 +26653,14 @@
   case $ac_option in
   # Handling of the options.
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
     ac_cs_recheck=: ;;
   --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
     echo "$ac_cs_version"; exit ;;
@@ -28340,6 +28364,14 @@
   case $ac_option in
   # Handling of the options.
   -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
+	: Avoid regenerating within pkgsrc
+	exit 0
     ac_cs_recheck=: ;;
   --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
     echo "$ac_cs_version"; exit ;;
