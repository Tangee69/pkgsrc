$NetBSD: patch-ca,v 1.3 2008/07/14 03:54:32 tnn Exp $

--- gio/glocalfile.c.orig	2008-07-02 00:30:15.000000000 +0200
+++ gio/glocalfile.c
@@ -53,7 +53,7 @@
 #if defined(HAVE_STATFS) && defined(HAVE_STATVFS)
 /* Some systems have both statfs and statvfs, pick the
    most "native" for these */
-# if defined(sun) && defined(__SVR4)
+# if (defined(sun) && defined(__SVR4)) || defined(__sgi)
    /* on solaris, statfs doesn't even have the
       f_bavail field */
 #  define USE_STATVFS
@@ -1008,8 +1008,12 @@ g_local_file_query_filesystem_info (GFil
 #if defined(HAVE_STRUCT_STATFS_F_FSTYPENAME)
   fstype = g_strdup(statfs_buffer.f_fstypename);
 #else
+#if defined(__sgi)
+  fstype = get_fs_type (statfs_buffer.f_fstyp);
+#else
   fstype = get_fs_type (statfs_buffer.f_type);
 #endif
+#endif
   if (fstype &&
       g_file_attribute_matcher_matches (attribute_matcher,
 					G_FILE_ATTRIBUTE_FILESYSTEM_TYPE))
