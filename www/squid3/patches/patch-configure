$NetBSD: patch-configure,v 1.9 2015/08/17 16:39:38 prlw1 Exp $

* Portability fix.
  http://bugs.squid-cache.org/show_bug.cgi?id=4306
* Fix broken tests for IPFilter
  http://bugs.squid-cache.org/show_bug.cgi?id=4301

--- configure.orig	2015-08-01 06:10:24.000000000 +0000
+++ configure
@@ -32753,7 +32753,7 @@ done
 ## Please see the COPYING and CONTRIBUTORS files for details.
 ##
 
-if test "x$with_krb5" == "xyes"; then
+if test "x$with_krb5" = "xyes"; then
   BUILD_HELPER="kerberos"
 fi
 
@@ -33327,7 +33327,7 @@ done
 ## Please see the COPYING and CONTRIBUTORS files for details.
 ##
 
-if test "x$with_krb5" == "xyes"; then
+if test "x$with_krb5" = "xyes"; then
   BUILD_HELPER="kerberos_ldap_group"
   if test "x$with_apple_krb5" = "xyes" ; then
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for main in -lresolv" >&5
@@ -38704,6 +38704,7 @@ if test "x$enable_ipf_transparent" != "x
 /* end confdefs.h.  */
 
 #     include <sys/types.h>
+#     include <sys/time.h>
 #     include <sys/ioccom.h>
 #     include <netinet/in.h>
 
@@ -38733,6 +38734,7 @@ else
 
 #define minor_t fubaar
 #       include <sys/types.h>
+#       include <sys/time.h>
 #       include <sys/ioccom.h>
 #       include <netinet/in.h>
 #undef minor_t
@@ -38756,8 +38758,7 @@ $as_echo "yes" >&6; }
 
 else
 
-        { $as_echo "$as_me:${as_lineno-$LINENO}: result: unable to make IPFilter work with netinet/ headers" >&5
-$as_echo "unable to make IPFilter work with netinet/ headers" >&6; }
+        as_fn_error $? "unable to make IPFilter work with netinet/ headers" "$LINENO" 5
 
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
@@ -38795,6 +38796,9 @@ ac_fn_cxx_check_header_compile "$LINENO"
 #if HAVE_SYS_TYPES_H
 #include <sys/types.h>
 #endif
+#if HAVE_SYS_TIME_H
+#include <sys/time.h>
+#endif
 #if HAVE_NETINET_IN_H
 #include <netinet/in.h>
 #endif
