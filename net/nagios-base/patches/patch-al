$NetBSD: patch-al,v 1.1 2008/03/18 21:53:41 tonnerre Exp $

--- cgi/history.c.orig	2006-03-21 22:31:46.000000000 +0100
+++ cgi/history.c
@@ -379,6 +379,7 @@ int process_cgivars(void){
 				host_name="";
 			else
 				strcpy(host_name,variables[x]);
+			strip_html_brackets(host_name);
 
 			display_type=DISPLAY_HOSTS;
 
@@ -401,6 +402,7 @@ int process_cgivars(void){
 				svc_description="";
 			else
 				strcpy(svc_description,variables[x]);
+			strip_html_brackets(svc_description);
 
 			display_type=DISPLAY_SERVICES;
 		        }
@@ -901,7 +903,7 @@ void get_history(void){
 
 				if(display_frills==TRUE)
 					printf("<img align='left' src='%s%s' alt='%s' title='%s'>",url_images_path,image,image_alt,image_alt);
-				printf("[%s] %s<br clear='all'>\n",date_time,temp_buffer);
+				printf("[%s] %s<br clear='all'>\n",date_time,html_encode(temp_buffer));
 				found_line=TRUE;
 			        }
 		        }
