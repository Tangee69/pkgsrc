$NetBSD: patch-aq,v 1.1 2008/03/18 21:53:41 tonnerre Exp $

--- cgi/statuswml.c.orig	2006-03-22 18:45:26.000000000 +0100
+++ cgi/statuswml.c
@@ -239,6 +239,7 @@ int process_cgivars(void){
 				hostgroup_name="";
 			else
 				strcpy(hostgroup_name,variables[x]);
+			strip_html_brackets(hostgroup_name);
 
 			if(!strcmp(hostgroup_name,"all"))
 				show_all_hostgroups=TRUE;
@@ -260,6 +261,7 @@ int process_cgivars(void){
 				host_name="";
 			else
 				strcpy(host_name,variables[x]);
+			strip_html_brackets(host_name);
 		        }
 
 		/* we found the service argument */
@@ -276,6 +278,7 @@ int process_cgivars(void){
 				service_desc="";
 			else
 				strcpy(service_desc,variables[x]);
+			strip_html_brackets(service_desc);
 		        }
 
 
@@ -317,6 +320,7 @@ int process_cgivars(void){
 				ping_address="";
 			else
 				strcpy(ping_address,variables[x]);
+			strip_html_brackets(ping_address);
 		        }
 
 		/* we found the traceroute argument */
@@ -333,6 +337,7 @@ int process_cgivars(void){
 				traceroute_address="";
 			else
 				strcpy(traceroute_address,variables[x]);
+			strip_html_brackets(traceroute_address);
 		        }
 
 	        }
