$NetBSD: patch-aj,v 1.3 2007/11/16 08:06:33 bjs Exp $

--- src/SocketCore.cc.orig	2007-08-28 12:36:33.000000000 -0400
+++ src/SocketCore.cc
@@ -331,7 +331,7 @@ void SocketCore::writeData(const char* d
     }
 #endif // HAVE_LIBSSL
 #ifdef HAVE_LIBGNUTLS
-    if((ret = gnutls_record_send(sslSession, data, len)) == len) {
+    if((ret = gnutls_record_send(sslSession, data, len)) != len) {
       throw new DlRetryEx(EX_SOCKET_SEND, gnutls_strerror(ret));
     }
 #endif // HAVE_LIBGNUTLS
