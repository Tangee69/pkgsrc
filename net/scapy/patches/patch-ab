$NetBSD: patch-ab,v 1.7 2024/10/01 01:08:29 gutteridge Exp $

Add DragonFly support.

--- scapy/arch/unix.py.orig	2024-09-28 13:11:32.000000000 +0000
+++ scapy/arch/unix.py
@@ -15,7 +15,7 @@ from fcntl import ioctl
 import scapy.config
 import scapy.utils
 from scapy.config import conf
-from scapy.consts import FREEBSD, NETBSD, OPENBSD, SOLARIS
+from scapy.consts import FREEBSD, NETBSD, OPENBSD, SOLARIS, DRAGONFLY
 from scapy.error import log_runtime, warning
 from scapy.pton_ntop import inet_pton
 from scapy.utils6 import in6_getscope, construct_source_candidate_set
@@ -96,7 +96,7 @@ def read_routes():
     """
     if SOLARIS:
         f = os.popen("netstat -rvn -f inet")
-    elif FREEBSD:
+    elif FREEBSD or DRAGONFLY:
         f = os.popen("netstat -rnW -f inet")  # -W to show long interface names
     else:
         f = os.popen("netstat -rn -f inet")
@@ -330,7 +330,7 @@ def read_routes6():
             destination, next_hop, flags = splitted_line[:3]
             dev = splitted_line[index]
         else:
-            # FREEBSD or DARWIN
+            # FREEBSD or DARWIN or DRAGONFLY
             if len(splitted_line) < 4:
                 warning("Not enough columns in route entry !")
                 continue
