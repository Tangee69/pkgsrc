$NetBSD: patch-ap,v 1.1 2008/06/21 20:01:59 joerg Exp $

--- src/port/netbsd/include/port_after.h.orig	2003-04-24 03:55:37.000000000 +0000
+++ src/port/netbsd/include/port_after.h
@@ -6,7 +6,6 @@
 #define USE_WAITPID
 #define HAVE_GETRUSAGE
 #define HAVE_FCHMOD
-#define NEED_PSELECT
 #define SETGRENT_VOID
 #define SETPWENT_VOID
 #define HAVE_SA_LEN
@@ -45,6 +44,14 @@
 #include <ifaddrs.h>
 #endif
 
+#if !defined(__NetBSD_Version__) || __NetBSD_Version__ < 300000000
+#define NEED_PSELECT
+#endif
+
+#if !defined(__NetBSD_Version__) || __NetBSD_Version__ >= 400000000
+#define HAVE_STRNDUP
+#endif
+
 /*
  * We need to know the IPv6 address family number even on IPv4-only systems.
  * Note that this is NOT a protocol constant, and that if the system has its
