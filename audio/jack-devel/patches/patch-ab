$NetBSD: patch-ab,v 1.4 2008/05/04 01:02:07 bjs Exp $

The default watchdog timeout is 10 seconds, which is too much for
usleep().  Let's nanosleep if it's available.

--- jackd/engine.c.orig	2008-03-17 18:26:49.000000000 -0400
+++ jackd/engine.c
@@ -1468,7 +1480,7 @@ jack_server_thread (void *arg)
 				    (engine, pfd[i].fd)) {
 					jack_error ("could not handle external"
 						    " client request");
-#ifdef JACK_USE_MACH_THREADS
+#ifdef JACK_HOST_HAS_BSD_POLL
                                     /* poll is implemented using
 				       select (see the macosx/fakepoll
 				       code). When the socket is closed
@@ -1481,7 +1493,7 @@ jack_server_thread (void *arg)
 				       and remove the client.
                                     */
                                     jack_client_disconnect(engine, pfd[i].fd);
-#endif /* JACK_USE_MACH_THREADS */
+#endif /* JACK_HOST_HAS_BSD_POLL */
 				}
 			}
 		}
