$NetBSD: patch-ac,v 1.1 2008/04/29 20:22:43 wiz Exp $

https://trac.xiph.org/changeset/14701

--- libspeex/speex_header.c.orig	2004-07-14 05:58:46.000000000 +0000
+++ libspeex/speex_header.c
@@ -157,6 +157,13 @@ SpeexHeader *speex_packet_to_header(char
    ENDIAN_SWITCH(le_header->frames_per_packet);
    ENDIAN_SWITCH(le_header->extra_headers);
 
+   if (le_header->mode >= SPEEX_NB_MODES || le_header->mode < 0)
+   {
+      speex_warning("Invalid mode specified in Speex header");
+      speex_free (le_header);
+      return NULL;
+   }
+
    return le_header;
 
 }
